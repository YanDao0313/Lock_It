# Lock It - 功能更新说明

## 1. 照片查看功能 ✓

### 功能描述

- 在设置界面新增"解锁记录"标签页，可以查看之前储存的拍摄照片
- 每次解锁尝试都会记录：
  - 时间戳
  - 成功/失败状态
  - 尝试次数（第几次尝试）
  - 拍摄的照片
  - 错误信息（如果有）

### 界面特性

- 统计信息卡片：总记录数、成功解锁数、密码错误数
- 照片列表：缩略图、状态标签、尝试次数、时间
- 详情弹窗：大图预览、详细信息、下载照片功能
- 删除功能：支持单条删除或清空所有记录
- 最多保留100条记录，自动清理旧记录

## 2. 相机选择配置 ✓

### 功能描述

- 在设置界面新增"摄像头"标签页
- 实时预览选中的摄像头画面
- 自动保存用户选择的摄像头设备ID
- 锁屏界面使用用户指定的摄像头拍照

### 边缘情况处理

- 如果指定的摄像头不可用，会尝试使用默认摄像头
- 显示"备用摄像头"提示，告知用户使用了回退方案
- 处理权限被拒绝的情况
- 处理没有找到摄像头设备的情况

## 3. 文字大小配置和主题优化 ✓

### 文字大小配置

- 主标题字体大小：20-80px 可调
- 副标题字体大小：16-48px 可调
- 底部文字大小：10-32px 可调
- 时间文字大小：12-40px 可调

### 主题系统优化

- 每个主题都支持浅色/深色两种配色方案
- 预置主题：蓝色警告、红色警告、黑色严肃、深色模式、浅色模式、绿色安全
- 自定义主题模式：允许用户完全自定义颜色
- 主题模式选项：浅色、深色、跟随系统、自定义

### 预览优化

- 预览界面可以切换深色/浅色模式查看效果
- 预览会根据文字长度自动调整显示大小
- 实时预览所有配置效果

## 4. 界面细节完善 ✓

### 边缘情况处理

- **空状态处理**：
  - 没有解锁记录时显示友好的空状态提示
  - 没有摄像头设备时显示错误提示
- **错误处理**：
  - 加载记录失败时显示重试按钮
  - 照片文件丢失或损坏时优雅处理
  - 摄像头权限被拒绝时提供引导

- **数据验证**：
  - 密码必须为6位数字
  - 时间段不能重叠（待完善）
  - 颜色格式验证

- **性能优化**：
  - 只保留最近100条记录
  - 照片数据懒加载
  - 删除记录时同步删除照片文件

## 5. 锁屏安全性加强 ✓

### 安全措施

- **Kiosk模式**：`kiosk: true` 阻止用户切换到其他应用
- **置顶显示**：`alwaysOnTop: true, 'screen-saver', 1` 确保窗口始终在最上层
- **焦点锁定**：定期检查和重新获取焦点（每500ms）
- **阻止快捷键**：`optimizer.watchWindowShortcuts(window)` 阻止系统快捷键
- **全屏模式**：`fullscreen: true` 覆盖整个屏幕
- **多显示器支持**：`setVisibleOnAllWorkspaces(true)` 在所有工作区显示
- **内容保护**：`setContentProtection(true)` 防止屏幕录制（部分系统支持）
- **阻止导航**：阻止页面导航和新窗口打开

### 窗口属性

```javascript
{
  fullscreen: true,
  alwaysOnTop: true,
  skipTaskbar: true,
  frame: false,
  kiosk: true,
  resizable: false,
  movable: false,
  minimizable: false,
  maximizable: false,
  closable: false,
  focusable: true
}
```

## 技术改进

### 类型安全

- 完整的 TypeScript 类型定义
- 更新了 `env.d.ts` 以支持新的 API

### IPC 通信新增

- `getUnlockRecords`: 获取解锁记录列表
- `deleteUnlockRecord`: 删除单条记录
- `clearUnlockRecords`: 清空所有记录
- `getSelectedCamera`: 获取选中的摄像头
- `setSelectedCamera`: 设置选中的摄像头

### 配置存储

- 新增 `selectedCamera`: 存储选中的摄像头设备ID
- 新增 `fontSizes`: 存储文字大小配置
- 新增 `lightBackgroundColor` 和 `lightTextColor`: 浅色模式配色
